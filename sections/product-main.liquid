{% comment %}
  Product Main Section - Conversion-Optimized Design
  Designed for maximum conversions with above-fold CTA, social proof, trust signals
{% endcomment %}

<section class="product-hero" id="product-hero">
  <div class="product-hero__container">
    <!-- Left Column - Product Images -->
    <div class="product-images">
      {% if product.featured_image %}
        <div class="product-image-main">
          <img 
            src="{{ product.featured_image | image_url: width: 1200 }}" 
            alt="{{ product.featured_image.alt | default: product.title }}"
            class="product-image-main__img"
            id="main-product-image"
            loading="eager"
            width="1200"
            height="1200"
          >
          {% if product.compare_at_price > product.price %}
            <div class="product-badge-sale">
              <span class="badge-sale__text">Save {{ product.compare_at_price | minus: product.price | times: 100 | divided_by: product.compare_at_price }}%</span>
            </div>
          {% endif %}
          <button class="product-image-zoom" aria-label="Zoom product image">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
          </button>
        </div>
        
        {% if product.images.size > 1 %}
          <div class="product-image-thumbnails">
            {% for image in product.images limit: 5 %}
              <button 
                class="product-thumbnail {% if forloop.first %}active{% endif %}"
                data-image-src="{{ image | image_url: width: 1200 }}"
                aria-label="View image {{ forloop.index }}"
              >
                <img 
                  src="{{ image | image_url: width: 150 }}" 
                  alt="{{ image.alt | default: product.title }}"
                  loading="lazy"
                  width="150"
                  height="150"
                >
              </button>
            {% endfor %}
          </div>
        {% endif %}
      {% else %}
        <div class="product-image-placeholder">
          {{ 'product-1' | placeholder_svg_tag: 'placeholder' }}
        </div>
      {% endif %}
    </div>
    
    <!-- Right Column - Product Info & CTA -->
    <div class="product-info">
      <!-- Trust Badge -->
      <div class="product-trust-badges">
        {% if product.metafields.custom.certificates %}
          <span class="trust-badge">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
              <path d="M9 12l2 2 4-4"/>
            </svg>
            {{ product.metafields.custom.certificates }}
          </span>
        {% endif %}
        <span class="trust-badge">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 7h-4M8 7H4M16 7v14M8 7v14M12 3v4M6 3h12"/>
          </svg>
          Free Shipping
        </span>
        <span class="trust-badge">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
            <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
            <line x1="12" y1="22.08" x2="12" y2="12"/>
          </svg>
          30-Day Returns
        </span>
      </div>
      
      <!-- Product Title -->
      <h1 class="product-title">{{ product.title }}</h1>
      
      <!-- Star Rating & Review Count -->
      <div class="product-rating-summary">
        <div class="rating-stars">
          {% assign avg_rating = 4.8 %}
          {% assign review_count = 127 %}
          {% assign rating_floor = avg_rating | floor %}
          {% assign next_star = rating_floor | plus: 1 %}
          {% assign rating_decimal = avg_rating | minus: rating_floor %}
          {% for i in (1..5) %}
            {% if i <= rating_floor %}
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="star-filled">
                <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
              </svg>
            {% elsif i == next_star and rating_decimal >= 0.5 %}
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="star-half">
                <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
              </svg>
            {% else %}
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="star-empty">
                <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
              </svg>
            {% endif %}
          {% endfor %}
        </div>
        <span class="rating-text">
          <strong>{{ avg_rating }}</strong> 
          <a href="#product-reviews" class="rating-link">({{ review_count }} reviews)</a>
        </span>
      </div>
      
      <!-- Price Display -->
      <div class="product-price-section">
        {% if product.compare_at_price > product.price %}
          <div class="price-original">
            <span class="price-label">Was:</span>
            <span class="price-value price-value--old">{{ product.compare_at_price | money }}</span>
          </div>
          <div class="price-current">
            <span class="price-label">Now:</span>
            <span class="price-value price-value--sale">{{ product.price | money }}</span>
            <span class="price-savings">Save {{ product.compare_at_price | minus: product.price | money }}</span>
          </div>
        {% else %}
          <div class="price-current">
            <span class="price-value">{{ product.price | money }}</span>
          </div>
        {% endif %}
      </div>
      
      <!-- Stock Availability -->
      {% if product.selected_or_first_available_variant.inventory_quantity > 0 and product.selected_or_first_available_variant.inventory_quantity <= 10 %}
        <div class="product-stock-alert">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="12"/>
            <line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <span>Only {{ product.selected_or_first_available_variant.inventory_quantity }} left in stock!</span>
        </div>
      {% elsif product.selected_or_first_available_variant.available %}
        <div class="product-stock-available">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          <span>In Stock - Ready to Ship</span>
        </div>
      {% endif %}
      
      <!-- Product Description (Short) -->
      {% if product.description != blank %}
        <div class="product-description-short">
          {{ product.description | truncatewords: 30 }}
          <button class="read-more-btn" data-target="full-description">Read More</button>
        </div>
      {% endif %}
      
      <!-- Product Form -->
      {% form 'product', product, class: 'product-form', id: 'product-form' %}
        <!-- Variant Selector -->
        {% if product.variants.size > 1 %}
          <div class="product-variants">
            {% for option in product.options_with_values %}
              <div class="variant-option">
                <label class="variant-label">{{ option.name }}</label>
                <div class="variant-options-grid">
                  {% for value in option.values %}
                    {% assign variant = product.variants | where: 'option1', value | first %}
                    {% if variant == blank %}
                      {% assign variant = product.variants | where: 'option2', value | first %}
                    {% endif %}
                    {% if variant == blank %}
                      {% assign variant = product.variants | where: 'option3', value | first %}
                    {% endif %}
                    <button
                      type="button"
                      class="variant-option-btn {% if option.selected_value == value %}active{% endif %}"
                      data-option="{{ option.name }}"
                      data-value="{{ value }}"
                      {% unless variant.available %}disabled{% endunless %}
                    >
                      {{ value }}
                      {% unless variant.available %}<span class="variant-unavailable">Sold Out</span>{% endunless %}
                    </button>
                  {% endfor %}
                </div>
              </div>
            {% endfor %}
            <select name="id" id="product-variant-select" class="variant-select-hidden" data-variant-select>
              {% for variant in product.variants %}
                <option 
                  value="{{ variant.id }}"
                  {% if variant == product.selected_or_first_available_variant %}selected{% endif %}
                  {% unless variant.available %}disabled{% endunless %}
                  data-price="{{ variant.price }}"
                  data-compare-price="{{ variant.compare_at_price }}"
                  data-inventory="{{ variant.inventory_quantity }}"
                >
                  {{ variant.title }}
                </option>
              {% endfor %}
            </select>
          </div>
        {% else %}
          <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
        {% endif %}
        
        <!-- Quantity Selector -->
        <div class="product-quantity">
          <label for="quantity-select" class="quantity-label">Quantity</label>
          <div class="quantity-selector">
            <button type="button" class="quantity-btn" data-action="decrease" aria-label="Decrease quantity">−</button>
            <input type="number" id="quantity-select" name="quantity" value="1" min="1" max="10" class="quantity-input">
            <button type="button" class="quantity-btn" data-action="increase" aria-label="Increase quantity">+</button>
          </div>
        </div>
        
        <!-- Add to Cart Button -->
        <button 
          type="submit" 
          name="add" 
          class="cta-button cta-button--primary"
          id="add-to-cart-btn"
          {% unless product.selected_or_first_available_variant.available %}disabled{% endunless %}
        >
          <span class="cta-button__icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="21" r="1"/>
              <circle cx="20" cy="21" r="1"/>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
            </svg>
          </span>
          <span class="cta-button__text">
            {% if product.selected_or_first_available_variant.available %}
              Add to Cart - {{ product.price | money }}
            {% else %}
              Sold Out
            {% endif %}
          </span>
        </button>
        
        <!-- Buy Now Button -->
        {% if product.selected_or_first_available_variant.available %}
          <button 
            type="button" 
            class="cta-button cta-button--secondary"
            id="buy-now-btn"
          >
            Buy Now
          </button>
        {% endif %}
        
        <!-- Trust Message -->
        <div class="product-trust-message">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
          </svg>
          <div>
            <strong>100% Secure Checkout</strong>
            <span>SSL encrypted & secure payment</span>
          </div>
        </div>
      {% endform %}
      
      <!-- Key Benefits (Quick) -->
      <div class="product-key-benefits">
        <h3 class="benefits-title">Why You'll Love This Product</h3>
        <ul class="benefits-list">
          {% if product.metafields.custom.key_benefit_1 %}
            <li>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
              {{ product.metafields.custom.key_benefit_1 }}
            </li>
          {% endif %}
          {% if product.metafields.custom.key_benefit_2 %}
            <li>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
              {{ product.metafields.custom.key_benefit_2 }}
            </li>
          {% endif %}
          {% if product.metafields.custom.key_benefit_3 %}
            <li>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
              {{ product.metafields.custom.key_benefit_3 }}
            </li>
          {% endif %}
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- Sticky Add to Cart Bar (Mobile) -->
<div class="sticky-cart-bar" id="sticky-cart-bar">
  <div class="sticky-cart-bar__content">
    <div class="sticky-cart-bar__info">
      <div class="sticky-cart-bar__image">
        {% if product.featured_image %}
          <img src="{{ product.featured_image | image_url: width: 80 }}" alt="{{ product.title }}" width="80" height="80">
        {% endif %}
      </div>
      <div class="sticky-cart-bar__details">
        <div class="sticky-cart-bar__title">{{ product.title | truncate: 40 }}</div>
        <div class="sticky-cart-bar__price">
          {% if product.compare_at_price > product.price %}
            <span class="price-old">{{ product.compare_at_price | money }}</span>
          {% endif %}
          <span class="price-current">{{ product.price | money }}</span>
        </div>
      </div>
    </div>
    <button type="button" class="sticky-cart-bar__button" id="sticky-add-to-cart">
      Add to Cart
    </button>
  </div>
</div>

{% stylesheet %}
  /* Main Container */
  .product-hero {
    width: 100%;
    max-width: 100%;
    padding: 60px 40px;
    background: var(--white);
    box-sizing: border-box;
  }

  .product-hero__container {
    max-width: 1400px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 80px;
    align-items: start;
  }

  /* Product Images */
  .product-images {
    position: sticky;
    top: 100px;
  }

  .product-image-main {
    position: relative;
    width: 100%;
    aspect-ratio: 1;
    border-radius: 12px;
    overflow: hidden;
    background: var(--bg);
    margin-bottom: 20px;
  }

  .product-image-main__img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    transition: transform 0.3s ease;
  }

  .product-image-main:hover .product-image-main__img {
    transform: scale(1.05);
  }

  .product-badge-sale {
    position: absolute;
    top: 20px;
    left: 20px;
    background: var(--gold);
    color: var(--white);
    padding: 8px 16px;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 700;
    z-index: 2;
    box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
  }

  .product-image-zoom {
    position: absolute;
    bottom: 20px;
    right: 20px;
    background: rgba(255, 255, 255, 0.9);
    border: none;
    border-radius: 50%;
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    z-index: 2;
  }

  .product-image-zoom:hover {
    background: var(--white);
    transform: scale(1.1);
  }

  .product-image-thumbnails {
    display: flex;
    gap: 12px;
    overflow-x: auto;
    padding-bottom: 10px;
  }

  .product-thumbnail {
    flex-shrink: 0;
    width: 80px;
    height: 80px;
    border: 2px solid transparent;
    border-radius: 8px;
    overflow: hidden;
    background: var(--bg);
    cursor: pointer;
    transition: all 0.3s ease;
    padding: 0;
  }

  .product-thumbnail.active {
    border-color: var(--forest-green);
  }

  .product-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Product Info */
  .product-info {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  /* Trust Badges */
  .product-trust-badges {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin-bottom: 8px;
  }

  .trust-badge {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 13px;
    color: var(--forest-green);
    font-weight: 500;
  }

  .trust-badge svg {
    flex-shrink: 0;
  }

  /* Product Title */
  .product-title {
    font-size: 42px;
    line-height: 1.2;
    font-weight: 600;
    margin: 0;
    color: var(--text);
    font-family: var(--font-heading);
  }

  /* Rating Summary */
  .product-rating-summary {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: -8px;
  }

  .rating-stars {
    display: flex;
    gap: 4px;
    color: #FFB800;
  }

  .rating-text {
    font-size: 14px;
    color: rgba(26, 26, 26, 0.7);
  }

  .rating-link {
    color: var(--forest-green);
    text-decoration: none;
  }

  .rating-link:hover {
    text-decoration: underline;
  }

  /* Price Section */
  .product-price-section {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 20px 0;
    border-top: 1px solid var(--border-color);
    border-bottom: 1px solid var(--border-color);
  }

  .price-original {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .price-current {
    display: flex;
    align-items: baseline;
    gap: 12px;
    flex-wrap: wrap;
  }

  .price-label {
    font-size: 14px;
    color: rgba(26, 26, 26, 0.6);
    font-weight: 400;
  }

  .price-value {
    font-size: 36px;
    font-weight: 700;
    color: var(--forest-green);
    font-family: var(--font-heading);
  }

  .price-value--old {
    font-size: 24px;
    text-decoration: line-through;
    color: rgba(26, 26, 26, 0.4);
    font-weight: 400;
  }

  .price-value--sale {
    color: var(--gold);
  }

  .price-savings {
    background: rgba(212, 175, 55, 0.1);
    color: var(--gold);
    padding: 4px 12px;
    border-radius: 4px;
    font-size: 14px;
    font-weight: 600;
  }

  /* Stock Alert */
  .product-stock-alert,
  .product-stock-available {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 16px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
  }

  .product-stock-alert {
    background: rgba(255, 87, 34, 0.1);
    color: #FF5722;
  }

  .product-stock-available {
    background: rgba(74, 124, 44, 0.1);
    color: var(--forest-green);
  }

  /* Description */
  .product-description-short {
    font-size: 15px;
    line-height: 1.7;
    color: rgba(26, 26, 26, 0.7);
  }

  .read-more-btn {
    color: var(--forest-green);
    background: none;
    border: none;
    font-size: 15px;
    font-weight: 500;
    cursor: pointer;
    padding: 0;
    margin-left: 4px;
    text-decoration: underline;
  }

  /* Variants */
  .product-variants {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .variant-option {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .variant-label {
    font-size: 15px;
    font-weight: 600;
    color: var(--text);
  }

  .variant-options-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }

  .variant-option-btn {
    padding: 12px 24px;
    border: 2px solid var(--border-color);
    background: var(--white);
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
  }

  .variant-option-btn:hover:not(:disabled) {
    border-color: var(--sage-green);
    background: rgba(74, 124, 44, 0.05);
  }

  .variant-option-btn.active {
    border-color: var(--forest-green);
    background: var(--forest-green);
    color: var(--white);
  }

  .variant-option-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .variant-unavailable {
    display: block;
    font-size: 10px;
    margin-top: 4px;
    opacity: 0.7;
  }

  .variant-select-hidden {
    display: none;
  }

  /* Quantity */
  .product-quantity {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .quantity-label {
    font-size: 15px;
    font-weight: 600;
    color: var(--text);
  }

  .quantity-selector {
    display: flex;
    align-items: center;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    width: fit-content;
    overflow: hidden;
  }

  .quantity-btn {
    width: 44px;
    height: 44px;
    border: none;
    background: var(--bg);
    font-size: 20px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .quantity-btn:hover {
    background: rgba(74, 124, 44, 0.1);
  }

  .quantity-input {
    width: 60px;
    height: 44px;
    border: none;
    border-left: 2px solid var(--border-color);
    border-right: 2px solid var(--border-color);
    text-align: center;
    font-size: 16px;
    font-weight: 600;
    -moz-appearance: textfield;
  }

  .quantity-input::-webkit-outer-spin-button,
  .quantity-input::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  /* CTA Buttons */
  .cta-button {
    width: 100%;
    padding: 18px 32px;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 600;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    text-transform: none;
    letter-spacing: 0;
  }

  .cta-button--primary {
    background: var(--forest-green);
    color: var(--white);
    box-shadow: 0 4px 12px rgba(74, 124, 44, 0.3);
  }

  .cta-button--primary:hover:not(:disabled) {
    background: var(--sage-green);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(74, 124, 44, 0.4);
  }

  .cta-button--secondary {
    background: transparent;
    color: var(--forest-green);
    border: 2px solid var(--forest-green);
  }

  .cta-button--secondary:hover {
    background: rgba(74, 124, 44, 0.05);
  }

  .cta-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  /* Trust Message */
  .product-trust-message {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px;
    background: rgba(74, 124, 44, 0.05);
    border-radius: 8px;
    color: var(--forest-green);
  }

  .product-trust-message svg {
    flex-shrink: 0;
  }

  .product-trust-message div {
    display: flex;
    flex-direction: column;
    gap: 2px;
    font-size: 13px;
  }

  .product-trust-message strong {
    font-size: 14px;
  }

  /* Key Benefits */
  .product-key-benefits {
    padding: 24px;
    background: rgba(74, 124, 44, 0.03);
    border-radius: 12px;
    margin-top: 8px;
  }

  .benefits-title {
    font-size: 18px;
    font-weight: 600;
    margin: 0 0 16px 0;
    color: var(--text);
  }

  .benefits-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .benefits-list li {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    font-size: 14px;
    color: rgba(26, 26, 26, 0.8);
    line-height: 1.6;
  }

  .benefits-list svg {
    flex-shrink: 0;
    margin-top: 2px;
    color: var(--forest-green);
  }

  /* Sticky Cart Bar (Mobile) */
  .sticky-cart-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: var(--white);
    border-top: 1px solid var(--border-color);
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    display: none;
    padding: 12px 20px;
  }

  .sticky-cart-bar__content {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
  }

  .sticky-cart-bar__info {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
    min-width: 0;
  }

  .sticky-cart-bar__image {
    width: 60px;
    height: 60px;
    border-radius: 8px;
    overflow: hidden;
    flex-shrink: 0;
    background: var(--bg);
  }

  .sticky-cart-bar__image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .sticky-cart-bar__details {
    flex: 1;
    min-width: 0;
  }

  .sticky-cart-bar__title {
    font-size: 14px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 4px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .sticky-cart-bar__price {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .sticky-cart-bar__price .price-old {
    font-size: 12px;
    text-decoration: line-through;
    color: rgba(26, 26, 26, 0.5);
  }

  .sticky-cart-bar__price .price-current {
    font-size: 16px;
    font-weight: 700;
    color: var(--forest-green);
  }

  .sticky-cart-bar__button {
    padding: 12px 24px;
    background: var(--forest-green);
    color: var(--white);
    border: none;
    border-radius: 8px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.3s ease;
  }

  .sticky-cart-bar__button:hover {
    background: var(--sage-green);
  }

  /* Responsive */
  @media (max-width: 968px) {
    .product-hero {
      padding: 40px 20px;
    }

    .product-hero__container {
      grid-template-columns: 1fr;
      gap: 40px;
    }

    .product-images {
      position: static;
    }

    .product-title {
      font-size: 32px;
    }

    .price-value {
      font-size: 28px;
    }

    .sticky-cart-bar {
      display: block;
    }

    .product-hero {
      padding-bottom: 100px;
    }
  }

  @media (max-width: 480px) {
    .product-hero {
      padding: 30px 16px;
    }

    .product-title {
      font-size: 28px;
    }

    .product-trust-badges {
      flex-direction: column;
      gap: 8px;
    }

    .variant-options-grid {
      gap: 8px;
    }

    .variant-option-btn {
      padding: 10px 20px;
      font-size: 13px;
    }
  }
{% endstylesheet %}

{% javascript %}
  (function() {
    // Image thumbnail switching
    const thumbnails = document.querySelectorAll('.product-thumbnail');
    const mainImage = document.getElementById('main-product-image');
    
    thumbnails.forEach(thumb => {
      thumb.addEventListener('click', function() {
        const imageSrc = this.getAttribute('data-image-src');
        if (imageSrc && mainImage) {
          mainImage.src = imageSrc;
          thumbnails.forEach(t => t.classList.remove('active'));
          this.classList.add('active');
        }
      });
    });

    // Variant selection
    const variantButtons = document.querySelectorAll('.variant-option-btn');
    const variantSelect = document.getElementById('product-variant-select');
    
    variantButtons.forEach(btn => {
      btn.addEventListener('click', function() {
        if (this.disabled) return;
        
        const option = this.getAttribute('data-option');
        const value = this.getAttribute('data-value');
        
        // Update active state
        const sameOptionButtons = document.querySelectorAll(`[data-option="${option}"]`);
        sameOptionButtons.forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        // Update hidden select
        if (variantSelect) {
          // Find matching variant
          const options = Array.from(variantSelect.options);
          const matchingVariant = options.find(opt => {
            const variantTitle = opt.textContent.toLowerCase();
            return variantTitle.includes(value.toLowerCase());
          });
          
          if (matchingVariant && !matchingVariant.disabled) {
            variantSelect.value = matchingVariant.value;
            variantSelect.dispatchEvent(new Event('change'));
          }
        }
      });
    });

    // Variant change handler
    if (variantSelect) {
      variantSelect.addEventListener('change', function() {
        const selectedOption = this.options[this.selectedIndex];
        const price = selectedOption.getAttribute('data-price');
        const comparePrice = selectedOption.getAttribute('data-compare-price');
        const inventory = selectedOption.getAttribute('data-inventory');
        
        // Update price display
        updatePriceDisplay(price, comparePrice);
        
        // Update stock alert
        updateStockAlert(inventory);
        
        // Update add to cart button
        const addToCartBtn = document.getElementById('add-to-cart-btn');
        const stickyBtn = document.getElementById('sticky-add-to-cart');
        
        if (selectedOption.disabled) {
          if (addToCartBtn) {
            addToCartBtn.disabled = true;
            addToCartBtn.querySelector('.cta-button__text').textContent = 'Sold Out';
          }
          if (stickyBtn) stickyBtn.disabled = true;
        } else {
          if (addToCartBtn) {
            addToCartBtn.disabled = false;
            const priceFormatted = formatMoney(price);
            addToCartBtn.querySelector('.cta-button__text').textContent = `Add to Cart - ${priceFormatted}`;
          }
          if (stickyBtn) stickyBtn.disabled = false;
        }
      });
    }

    // Quantity selector
    const quantityInput = document.getElementById('quantity-select');
    const quantityButtons = document.querySelectorAll('.quantity-btn');
    
    quantityButtons.forEach(btn => {
      btn.addEventListener('click', function() {
        const action = this.getAttribute('data-action');
        const currentValue = parseInt(quantityInput.value) || 1;
        const min = parseInt(quantityInput.getAttribute('min')) || 1;
        const max = parseInt(quantityInput.getAttribute('max')) || 10;
        
        if (action === 'increase' && currentValue < max) {
          quantityInput.value = currentValue + 1;
        } else if (action === 'decrease' && currentValue > min) {
          quantityInput.value = currentValue - 1;
        }
      });
    });

    // Sticky cart bar functionality
    const stickyCartBar = document.getElementById('sticky-cart-bar');
    const stickyAddToCartBtn = document.getElementById('sticky-add-to-cart');
    
    if (stickyAddToCartBtn) {
      stickyAddToCartBtn.addEventListener('click', function() {
        const mainForm = document.getElementById('product-form');
        if (mainForm) {
          const submitBtn = mainForm.querySelector('button[type="submit"]');
          if (submitBtn) submitBtn.click();
        }
      });
    }

    // Buy Now button
    const buyNowBtn = document.getElementById('buy-now-btn');
    if (buyNowBtn) {
      buyNowBtn.addEventListener('click', function() {
        const form = document.getElementById('product-form');
        if (form) {
          // Add a hidden input to indicate buy now
          const buyNowInput = document.createElement('input');
          buyNowInput.type = 'hidden';
          buyNowInput.name = 'return_to';
          buyNowInput.value = '/checkout';
          form.appendChild(buyNowInput);
          
          const submitBtn = form.querySelector('button[type="submit"]');
          if (submitBtn) submitBtn.click();
        }
      });
    }

    // Helper functions
    function updatePriceDisplay(price, comparePrice) {
      const priceSection = document.querySelector('.product-price-section');
      if (!priceSection) return;
      
      const priceNum = parseInt(price) / 100;
      const comparePriceNum = comparePrice ? parseInt(comparePrice) / 100 : null;
      
      if (comparePriceNum && comparePriceNum > priceNum) {
        const savings = comparePriceNum - priceNum;
        priceSection.innerHTML = `
          <div class="price-original">
            <span class="price-label">Was:</span>
            <span class="price-value price-value--old">${formatMoney(comparePrice)}</span>
          </div>
          <div class="price-current">
            <span class="price-label">Now:</span>
            <span class="price-value price-value--sale">${formatMoney(price)}</span>
            <span class="price-savings">Save ${formatMoney(savings * 100)}</span>
          </div>
        `;
      } else {
        priceSection.innerHTML = `
          <div class="price-current">
            <span class="price-value">${formatMoney(price)}</span>
          </div>
        `;
      }
      
      // Update sticky bar price
      const stickyPrice = document.querySelector('.sticky-cart-bar__price .price-current');
      if (stickyPrice) {
        stickyPrice.textContent = formatMoney(price);
      }
    }

    function updateStockAlert(inventory) {
      const stockAlert = document.querySelector('.product-stock-alert');
      const stockAvailable = document.querySelector('.product-stock-available');
      
      // Remove existing alerts
      if (stockAlert) stockAlert.remove();
      if (stockAvailable) stockAvailable.remove();
      
      const inventoryNum = parseInt(inventory) || 0;
      const productInfo = document.querySelector('.product-info');
      
      if (inventoryNum > 0 && inventoryNum <= 10) {
        const alert = document.createElement('div');
        alert.className = 'product-stock-alert';
        alert.innerHTML = `
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="12"/>
            <line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <span>Only ${inventoryNum} left in stock!</span>
        `;
        const priceSection = document.querySelector('.product-price-section');
        if (priceSection && priceSection.nextSibling) {
          productInfo.insertBefore(alert, priceSection.nextSibling);
        }
      } else if (inventoryNum > 10) {
        const available = document.createElement('div');
        available.className = 'product-stock-available';
        available.innerHTML = `
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          <span>In Stock - Ready to Ship</span>
        `;
        const priceSection = document.querySelector('.product-price-section');
        if (priceSection && priceSection.nextSibling) {
          productInfo.insertBefore(available, priceSection.nextSibling);
        }
      }
    }

    function formatMoney(cents) {
      // Get currency symbol from Shopify
      const currencySymbol = '{{ cart.currency.symbol }}' || '₹';
      const amount = (parseInt(cents) / 100).toFixed(2);
      return currencySymbol + amount;
    }

    // Initialize on load
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }

    function init() {
      // Trigger initial variant change to set up display
      if (variantSelect) {
        variantSelect.dispatchEvent(new Event('change'));
      }
    }
  })();
{% endjavascript %}

{% schema %}
{
  "name": "Product Main",
  "settings": [],
  "presets": [
    {
      "name": "Product Main"
    }
  ]
}
{% endschema %}
